(this["webpackJsonpkindness-tracker"]=this["webpackJsonpkindness-tracker"]||[]).push([[0],{114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(20),i=n.n(r),s=(n(89),n(3)),o=n(72),l=n.n(o),d=n(13),u=n(8),j=n(1),b=n(24),h=n.n(b),f="https://docs.google.com/spreadsheets/d/1IqEBIcnFZ_BFCrD8jhk11yVoOjfxzZpiZLdL4cL3oK0/pubhtml",p="What is the ID Number on your kindness card? (We need this to track the spread of kindness!)",O="center_lng",m="center_lat",g=n(40),x=n(41),v="lng",y="lat",N=function(e,t){return!(!e||!t)&&e.index==t.index},k=function(e,t){var n=t[p];return(0===n?e:e.filter((function(e){return e[p]===n||0===e[p]}))).sort((function(e,t){return e.dateTime.toMillis()-t.dateTime.toMillis()}))},T=function(e){var t=e.street_number,n=e.street_name,c=t&&n?"".concat(t?"".concat(t," "):null).concat(n):null,a=e.admin_level_3,r=e.admin_level_1,i=a||r?"".concat(a).concat(a?", ".concat(r):r):null,s=e.zip_code,o="".concat(c||"No street address provided","\n").concat(i||"No city/state provided").concat(s?"\n".concat(s):"");return{kindness:e["Tell us about the act of kindness you received!"],dateString:e.dateTime.toLocaleString(x.DateTime.DATETIME_SHORT),location:o,cityState:i}},S=function(e,t){u.select(".map-tooltip").transition().duration(0).style("opacity",.8).style("left","".concat(e.pageX+50,"px")).style("top","".concat(e.pageY-50,"px"))},w=function(e){u.select(".map-tooltip").transition().duration(500).style("opacity",0).on("end",e)},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"steelblue";return u.selectAll(".circle").transition().duration(500).style("fill",e).style("opacity",1)},M=function(e){return"circle-".concat(e.index)},I=function(e){return"circle circle-".concat(e[p])},L=function(e,t){return e.project(new h.a.LngLat(t.center_lng,t.center_lat))},D=function(e){u.selectAll(".circle").attr("cx",(function(t){return L(e,t).x})).attr("cy",(function(t){return L(e,t).y}))},_=function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=0,a=0;n||(c=t/69),a=c;var r=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?1:5,i=function(t){return e.map((function(e){return e[t]}))},s=Math.max.apply(Math,Object(d.a)(i(v))),o=Math.min.apply(Math,Object(d.a)(i(v))),l=Math.max.apply(Math,Object(d.a)(i(y))),u=Math.min.apply(Math,Object(d.a)(i(y)));return n&&(c=(s-o)*t,a=12*t*(l-u)),{topRight:{lng:s+c,lat:u+a},bottomLeft:{lng:o-c*r,lat:l-a}}}(e.map((function(e){return{lng:e.center_lng,lat:e.center_lat}})),e.length>1?.1:1,e.length>1,e.length>1)},F=function(e){setTimeout((function(){u.select(".map-svg").selectAll("use").remove(),u.select(".map-svg").append("use").attr("xlink:href",e)}),500)},J=n(35),E=function(e){var t=e.node,n=e.isSelected;if(!t)return null;console.log("rendering tooltip");var c,a,r=T(t),i=r.kindness,s=r.cityState;return Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:(c=i,a=140,c.length>a?"".concat(c.substring(0,a),"..."):c)})}),Object(j.jsx)("p",{children:Object(j.jsx)("i",{children:s})}),Object(j.jsx)("p",{children:n?null:"Click for more info!"})]})};n(114);h.a.accessToken="pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ",h.a.workerClass=J.a;var z=function(e){var t=e.trace,n=e.setIsLoading,a=e.selectedNode,r=e.setSelectedNode,i=e.hoveredNode,o=e.setHoveredNode,l=e.isTracing,d=e.setTrace,b=e.resetTrace,f=Object(c.useState)(null),O=Object(s.a)(f,2),m=O[0],g=O[1],x=Object(c.useState)(null),v=Object(s.a)(x,2),y=v[0],T=v[1],L=Object(c.useRef)(null);return Object(c.useEffect)((function(){if(null===m)!function(e){var t=e.setMap,n=e.mapContainer,c=new h.a.Map({container:n.current,style:"mapbox://styles/mapbox/light-v10",center:[-100,40],zoom:3});c.on("load",(function(){t(c)}))}({setMap:g,mapContainer:L});else{var e=m.getCanvasContainer();u.select(e).append("svg").attr("class","map-svg").attr("width","100%").attr("height","100%").style("position","absolute").style("z-index",2).style("top",0).style("left",0),m.on("viewreset",(function(){return D(m)})),m.on("move",(function(){return D(m)})),m.on("moveend",(function(){return D(m)})),m.on("load",(function(){return m.resize()}))}}),[m]),Object(c.useEffect)((function(){if(m&&t){console.log(">>> JOINING"),u.select(".map-svg").selectAll("circle").data(t,(function(e){return e.hash})).join((function(e){return e.append("circle").attr("id",M).attr("class",I).attr("r",10).style("fill","steelblue").style("opacity",(function(e){return a&&N(e,a)?1:a&&!N(e,a)?.5:1})).on("click",(function(e,t){return r(t)})).on("mouseover",(function(e,t){o(t),S(e)})).on("mousemove",(function(e,t){S(e)})).on("mouseout",(function(e,t){w((function(){return o(null)}))}))}),(function(e){return e}),(function(e){return e.remove()})),D(m),n(!1);var e=_(t);T(e)}}),[m,t]),Object(c.useEffect)((function(){y&&(!function(e,t){var n=t.topRight,c=t.bottomLeft;e.fitBounds([[c.lng,c.lat],[n.lng,n.lat]],{duration:3e3})}(m,y),setTimeout((function(){return w((function(){return o(null)}))}),500))}),[y]),Object(c.useEffect)((function(){if(l){if(0===a[p]){var e=_(t);T(e)}C("purple").attr("r",10).style("opacity",.5);var n="#".concat(M(a));u.select(n).transition().duration(500).style("fill","green").attr("r",30).style("opacity",1),F(n)}else if(a){C().style("opacity",.5);var c="#".concat(M(a));u.select(c).transition().duration(500).style("fill","red").style("opacity",1).attr("r",10),F(c);var r=_([a]);T(r)}else if(t){var i=_(t);T(i),C()}}),[a,l]),Object(c.useEffect)((function(){if(l){var e=k(t,a);d(e)}else b()}),[l]),Object(j.jsx)("div",{ref:function(e){return L.current=e},className:"map-container-div",children:Object(j.jsx)("div",{className:"map-tooltip",style:{opacity:0},children:Object(j.jsx)(E,{node:i,isSelected:N(i,a)})})})},A=n(142),Y=(n(115),function(e){var t=e.node;if(console.log("rendering card"),!t)return null;console.log(t);var n=T(t),c=n.kindness,a=n.dateString,r=n.location;return Object(j.jsxs)("div",{className:"kindness-card-inner",children:[Object(j.jsx)("p",{children:"Act of Kindness:"}),Object(j.jsx)("div",{className:"kindness-card-description",children:Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:c||"No kindness description provided!"})})}),Object(j.jsx)("p",{children:"Location:"}),Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:r})}),Object(j.jsx)("p",{children:"Date & Time:"}),Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:a})})]})}),U=(n(116),function(){return console.log("rendering loading"),Object(j.jsxs)("div",{className:"loading-wrapper",children:[Object(j.jsx)("div",{className:"la-ball-clip-rotate la-2x",children:Object(j.jsx)("div",{})}),Object(j.jsx)("p",{children:"Loading..."})]})}),B=n(74),K=n.n(B),P=n(76),R=n.n(P),Z=n(77),H=n.n(Z),W=function(){return console.log("rendering side info card"),Object(j.jsxs)("div",{children:[Object(j.jsx)("hr",{className:"sidebar-divider"}),Object(j.jsxs)("div",{className:"sidebar-info-row",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(K.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Click"})," a circle to explore that act of kindness further!"]})})]}),Object(j.jsxs)("div",{className:"sidebar-info-row",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(R.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:["Then, you can ",Object(j.jsx)("b",{children:"trace"})," that act of kindness to see how may people have paid it forward."]})})]}),Object(j.jsxs)("div",{className:"sidebar-info-row sidebar-info-row-toggle",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(H.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:["Switch between ",Object(j.jsx)("b",{children:"real-time"})," and ",Object(j.jsx)("b",{children:"generated"})," data using the toggle below."]})})]})]})},G=n(78),V=n.n(G),X=n(79),Q=n.n(X),q=function(e){var t=e.isTracing,n=e.setIsTracing,c=e.trace,a=e.selectedNode,r=e.setSelectedNode;if(console.log("rendering trace"),!t)return null;var i=c.indexOf(a),s=c.length;return Object(j.jsxs)("div",{className:"trace-stepper-wrapper",children:[Object(j.jsx)("div",{className:"trace-stepper-button-exit",children:Object(j.jsx)(A.a,{variant:"contained",style:{backgroundColor:"red",color:"white"},onClick:function(){n(!1)},children:"Exit Trace Mode"})}),Object(j.jsxs)("div",{className:"trace-stepper-button-horizontal",children:[Object(j.jsx)(A.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:0===i,onClick:function(){return r(c[0])},children:"First"}),Object(j.jsx)(A.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:0===i,onClick:function(){return r(c[i-1])},children:Object(j.jsx)(V.a,{})}),Object(j.jsx)(A.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:i===s-1,onClick:function(){return r(c[i+1])},children:Object(j.jsx)(Q.a,{})}),Object(j.jsx)(A.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:i===s-1,onClick:function(){return r(c[s-1])},children:"Last"})]}),Object(j.jsx)("p",{children:"".concat(i+1," / ").concat(c.length)}),Object(j.jsx)(Y,{node:a})]})},$=n(144),ee=n(143),te=function(e){var t=e.dataUrl,n=e.setDataUrl,c=t===f,a=t===f?"Viewing Real Data":"Viewing Fake Data";return Object(j.jsx)($.a,{control:Object(j.jsx)(ee.a,{checked:c,onChange:function(e){var t=e.target.checked;n(t?f:"https://docs.google.com/spreadsheets/d/1ILNeaJC675bNSCWHgAK-2hD6MNZB38PYh7Y90MncF50/pubhtml")},color:"primary"}),labelPlacement:"top",label:a})},ne=function(e){var t=e.isLoading,n=e.selectedNode,c=e.setSelectedNode,a=e.isTracing,r=e.setIsTracing,i=e.trace,s=e.dataUrl,o=e.setDataUrl;console.log("rendering sidebar");var l=0;n&&(l=k(i,n).length);return Object(j.jsxs)("div",{className:"sidebar-flex",children:[Object(j.jsx)("h1",{children:"Kindness Tracker"}),t?Object(j.jsx)(U,{}):null,t||n?null:Object(j.jsx)(W,{}),n&&!a?Object(j.jsxs)("div",{className:"sidebar-clear-div",children:[Object(j.jsx)(A.a,{variant:"contained",style:{backgroundColor:"red",color:"white"},className:"sidebar-button-below",onClick:function(){c(null),r(!1)},children:"Clear Selection"}),Object(j.jsx)(A.a,{variant:"contained",style:{backgroundColor:"green",color:"white"},className:"sidebar-button-below",onClick:function(){return r(!0)},children:"Trace this Act!"}),Object(j.jsx)("h1",{children:l}),Object(j.jsx)("p",{children:"acts of kindness are connected"})]}):null,a?null:Object(j.jsx)("div",{className:"selected-card-wrapper",children:Object(j.jsx)(Y,{node:n})}),Object(j.jsx)(q,{isTracing:a,setIsTracing:r,trace:i,selectedNode:n,setSelectedNode:c}),Object(j.jsxs)("div",{className:"sidebar-bottom-content",children:[Object(j.jsx)("div",{className:"data-toggle-outer",children:Object(j.jsx)(te,{dataUrl:s,setDataUrl:o})}),Object(j.jsx)("p",{className:"sidebar-small-text",children:"Christian Moroney, Jackson Bernatchez, Kevin Lyons"}),Object(j.jsx)("p",{className:"sidebar-small-text",children:"6.859 Final Project Spring 2021"}),Object(j.jsx)("div",{children:Object(j.jsx)("a",{href:"https://github.com/6859-sp21/final-project-kindness-tracker",target:"_blank",children:Object(j.jsx)("img",{className:"sidebar-git-image",src:"https://image.flaticon.com/icons/png/512/25/25231.png"})})})]})]})},ce=n(42),ae=n.n(ce);n(121);ae.a.workerClass=J.a,ae.a.accessToken="pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ";var re=function(){var e=Object(c.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(null),i=Object(s.a)(r,2),o=i[0],d=i[1],u=Object(c.useState)(!0),b=Object(s.a)(u,2),h=b[0],v=b[1],y=Object(c.useState)(null),N=Object(s.a)(y,2),k=N[0],T=N[1],S=Object(c.useState)(null),w=Object(s.a)(S,2),C=w[0],M=w[1],I=Object(c.useState)(!1),L=Object(s.a)(I,2),D=L[0],_=L[1],F=Object(c.useState)(f),J=Object(s.a)(F,2),E=J[0],A=J[1];Object(c.useEffect)((function(){window.innerWidth<800&&alert("We see you're on mobile! Rotate your phone sideways for the best experience. Check out our app on your computer too!")}),[]);var Y=function(){console.log("fetching!"),l.a.init({key:E,simpleSheet:!0}).then((function(e){var t=function(e){var t=e?e.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{index:t,dateTime:x.DateTime.fromFormat(e.Timestamp,"M/d/yyyy H:mm:ss"),hash:"".concat(t,"-").concat(e.Timestamp)})})):null,n=[p,O,m];return t.map((function(e){return n.forEach((function(t){e[t]=+e[t]})),e}))}(e);console.log(t),a(t),d(t)})).catch(console.warn)};Object(c.useEffect)((function(){null===n&&Y()}),[n]),Object(c.useEffect)((function(){null!==n&&(v(!0),T(null),M(null),_(!1),Y())}),[E]);return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)("div",{className:"horizontal-stack",children:[Object(j.jsx)("div",{className:"left-sidebar",children:Object(j.jsx)(ne,{isLoading:h,selectedNode:k,setSelectedNode:T,isTracing:D,setIsTracing:_,trace:o,dataUrl:E,setDataUrl:A})}),Object(j.jsx)("div",{className:"map-wrapper",children:Object(j.jsx)(z,{trace:o,setIsLoading:v,selectedNode:k,setSelectedNode:T,hoveredNode:C,setHoveredNode:M,isTracing:D,setTrace:d,resetTrace:function(){return d(n)}})})]})})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,145)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(re,{})}),document.getElementById("root")),ie()},89:function(e,t,n){}},[[122,1,2]]]);
//# sourceMappingURL=main.3b875673.chunk.js.map