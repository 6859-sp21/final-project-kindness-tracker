{"version":3,"sources":["utils/dataConstants.js","utils/dataUtils.js","components/mapboxGLMap/mapUtils.js","components/mapboxGLMap/lineUtils.js","arrow.png","components/tooltip/index.js","utils/stringUtils.js","utils/appMode.js","components/mapboxGLMap/index.js","components/sidebar/kindnessCard.js","components/sidebar/loadingSpinner.js","components/sidebar/infoCard.js","components/sidebar/traceStepper.js","components/sidebar/dataToggle.js","components/sidebar/index.js","components/search/index.js","App.js","reportWebVitals.js","index.js"],"names":["REAL_DATA_URL","ID_KEY_NAME","STREET_KEY_NAME","CITY_KEY_NAME","STATE_KEY_NAME","ZIP_KEY_NAME","KINDNESS_KEY_NAME","CENTER_LNG_KEY_NAME","CENTER_LAT_KEY_NAME","LNG_KEY","LAT_KEY","nodesAreEqual","one","two","index","filterTraceListForNode","data","node","id","DataConstants","filter","d","sort","a","b","dateTime","toMillis","formatFieldsForDisplay","streetNumber","street","address","city","state","cityState","zip","location","kindness","dateString","toLocaleString","DateTime","DATETIME_SHORT","hideTooltip","callback","d3","transition","duration","style","on","resetAllCircleColors","fill","uniqueCircleId","circleClass","projectLngLatToXY","map","project","mapboxgl","LngLat","mapRender","attr","x","y","getBoudingObjectForTraceList","trace","lngLatPoints","paddingMiles","isRatioPadding","paddingDegreesLng","paddingDegreesLat","leftPadConstant","extractKey","key","maxLng","Math","max","minLng","min","maxLat","minLat","topRight","lng","lat","bottomLeft","DataUtils","length","bringCircleWithIdToFront","setTimeout","selectAll","remove","append","convertDatumToLngLatArray","computePointId","drawArcBetweenNodes","origin","destination","hash","idPoint","getSource","route","constructFeatureCollection","arcifyResult","lineDistance","turf","features","numSteps","floor","arc","i","segment","push","geometry","coordinates","arcifyFeatureCollection","routeProc","console","log","point","addSource","addLayer","loadImage","error","image","addImage","counter","animatePoint","start","end","properties","bearing","source","setData","requestAnimationFrame","clearArcsForId","removeLayer","removeSource","TooltipContents","isSelected","inp","substring","DEFAULT","SELECTED","SEARCHING","TRACING","accessToken","workerClass","MapboxWorker","MapboxGLMap","setIsLoading","selectedNode","setSelectedNode","hoveredNode","setHoveredNode","mode","setTrace","resetTrace","useState","setMap","boundingObject","setBoundingObject","mapContainer","useRef","prevLineId","setPrevLineId","nextLineId","setNextLineId","useEffect","Map","container","current","center","zoom","MapUtils","getCanvasContainer","join","enter","e","pageX","pageY","update","exit","boundingObjectNew","fitBounds","AppMode","nodes","newPrevLineId","newNextLineId","traceIndex","indexOf","prevNode","nextNode","LineUtils","drawAndZoomLines","traceNew","ref","el","className","KindnessCard","LoadingSpinner","SidebarInfoCard","fontSize","TraceStepper","exitTraceMode","n","Button","variant","backgroundColor","color","onClick","disabled","DataToggle","dataUrl","setDataUrl","checked","label","FormControlLabel","control","Switch","onChange","event","eventChecked","target","labelPlacement","Sidebar","isLoading","clearSelectedNode","setMode","filterText","traceCount","href","src","KindnessSearchBar","filterNodes","setFilterText","value","cancelOnEscape","onRequestSearch","onCancelSearch","placeholder","App","trie","setTrie","window","innerWidth","alert","fetchData","Tabletop","init","simpleSheet","then","dataProc","fromFormat","numericalFields","forEach","f","ts","TrieSearch","addAll","catch","warn","text","dataFiltSearch","get","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6ddc2b36.chunk.js","sourcesContent":["// const TIMESTAMP_KEY_NAME = 'Timestamp'\n// const ID_KEY_NAME = 'ID NUMBER on kindness card'\n// const CITY_KEY_NAME = 'CITY where act of kindness took place'\n// const STATE_KEY_NAME = 'STATE'\n// const ZIP_KEY_NAME = '[OPTIONAL] ZIP CODE'\n// const STREET_KEY_NAME = '[Optional] STREET NAME'\n// const KINDNESS_KEY_NAME = '[Optional] Tell us about the act of kindness you received!'\n// const CENTER_LNG_KEY_NAME = 'CenterLon'\n// const CENTER_LAT_KEY_NAME = 'CenterLat'\n\nconst REAL_DATA_URL = 'https://docs.google.com/spreadsheets/d/1IqEBIcnFZ_BFCrD8jhk11yVoOjfxzZpiZLdL4cL3oK0/pubhtml'\n\n// Massachusetts spoof data\nconst MASS_SPOOF_DATA_URL = 'https://docs.google.com/spreadsheets/d/1ILNeaJC675bNSCWHgAK-2hD6MNZB38PYh7Y90MncF50/pubhtml'\n\n// USA spoof data\nconst USA_SPOOF_DATA_URL = 'https://docs.google.com/spreadsheets/d/1BvBwyy1xYYhdiokMfbyxssu5nlB0arRMvxyuQLCzsH4/pubhtml'\n\nconst SPOOF_DATA_URL = MASS_SPOOF_DATA_URL\n\n// this is the format used by Google sheets\nconst TIMESTAMP_FORMAT = 'M/d/yyyy H:mm:ss'\n// 4/28/2021 13:36:45\n\n// this is the format that was originally used by Jack in spoof data\n// const TIMESTAMP_FORMAT = 'MM/dd/yy h:mm a'\n\n// TOOD add constants for new parsed geo fields when those are avaiable\nconst TIMESTAMP_KEY_NAME = 'Timestamp'\nconst ID_KEY_NAME = 'What is the ID Number on your kindness card? (We need this to track the spread of kindness!)'\nconst STREET_NUMBER_KEY_NAME = 'street_number'\nconst STREET_KEY_NAME = 'street_name'\nconst CITY_KEY_NAME = 'admin_level_3'\nconst STATE_KEY_NAME = 'admin_level_1'\nconst ZIP_KEY_NAME = 'zip_code'\nconst KINDNESS_KEY_NAME = 'Tell us about the act of kindness you received!'\nconst CENTER_LNG_KEY_NAME = 'center_lng'\nconst CENTER_LAT_KEY_NAME = 'center_lat'\n\n// also add a constant for the root ID\nconst ROOT_ACT_ID = 0\n\nexport {\n    TIMESTAMP_KEY_NAME,\n    ID_KEY_NAME,\n    STREET_NUMBER_KEY_NAME,\n    STREET_KEY_NAME,\n    CITY_KEY_NAME,\n    STATE_KEY_NAME,\n    ZIP_KEY_NAME,\n    KINDNESS_KEY_NAME,\n    CENTER_LNG_KEY_NAME,\n    CENTER_LAT_KEY_NAME,\n\n    REAL_DATA_URL,\n    SPOOF_DATA_URL,\n\n    TIMESTAMP_FORMAT,\n\n    ROOT_ACT_ID,\n}\n","import { DateTime } from  'luxon'\nimport * as DataConstants from './dataConstants'\n\nconst DEGREES_TO_MILES = 69\nconst LNG_KEY = 'lng'\nconst LAT_KEY = 'lat'\n\nconst processRawSheetsData = (data) => {\n    const dataProc = data ? data.map((d, i) => ({\n        ...d,\n        index: i,\n        dateTime: DateTime.fromFormat(d[DataConstants.TIMESTAMP_KEY_NAME], DataConstants.TIMESTAMP_FORMAT),\n        hash: `${i}-${d[DataConstants.TIMESTAMP_KEY_NAME]}`\n    })) : null\n\n    // convert certain fields to numbers\n    const numericalFields = [\n        DataConstants.ID_KEY_NAME,\n        DataConstants.CENTER_LNG_KEY_NAME,\n        DataConstants.CENTER_LAT_KEY_NAME,\n    ]\n\n    const dataProcNumerical = dataProc.map(d => {\n        numericalFields.forEach(f => {\n            d[f] = +d[f]\n        })\n        return d\n    })\n    return dataProcNumerical\n}\n\nconst nodesAreEqual = (one, two) => {\n    if (! one || ! two)\n        return false\n        \n    return one.index == two.index\n}\n\nconst computeLngLatBoundingBox = (lngLatPoints, paddingMiles, isRatioPadding = false, padLeft = true) => {\n    // compute top right and bottom left\n    // then, add some padding amount in miles\n    var paddingDegreesLng = 0\n    var paddingDegreesLat = 0\n    if (! isRatioPadding)\n        paddingDegreesLng = paddingMiles / DEGREES_TO_MILES\n        paddingDegreesLat = paddingDegreesLng\n    \n    // TODO fix hard coding here\n    const leftPadConstant = padLeft ? 5 : 1\n\n    const extractKey = key => lngLatPoints.map((d => d[key]))\n\n    const maxLng = Math.max(...extractKey(LNG_KEY))\n    const minLng = Math.min(...extractKey(LNG_KEY))\n    const maxLat = Math.max(...extractKey(LAT_KEY))\n    const minLat = Math.min(...extractKey(LAT_KEY))\n\n    if (isRatioPadding) {\n        paddingDegreesLng = (maxLng - minLng) * paddingMiles\n        paddingDegreesLat = (maxLat - minLat) * (paddingMiles * 12)\n    }\n\n    return {\n        topRight: {\n            lng: maxLng + paddingDegreesLng,\n            lat: minLat + paddingDegreesLat,\n        },\n        bottomLeft: {\n            lng: minLng - paddingDegreesLng * leftPadConstant,\n            lat: maxLat - paddingDegreesLat,\n        }\n    }\n}\n\nconst filterTraceListForNode = (data, node) => {\n    let dataFilt;\n    const id = node[DataConstants.ID_KEY_NAME]\n    if (id === DataConstants.ROOT_ACT_ID) {\n        // if the id is the root note, just select all of data\n        dataFilt = data\n    } else {\n        // select this id, and the root\n        dataFilt = data\n            .filter(d => \n                (d[DataConstants.ID_KEY_NAME] === id) ||\n                (d[DataConstants.ID_KEY_NAME] === DataConstants.ROOT_ACT_ID)\n            )\n    }\n\n    // apply sorting by date\n    const traceNew = dataFilt.sort((a, b) => a.dateTime.toMillis() - b.dateTime.toMillis())\n    return traceNew\n}\n\nconst formatFieldsForDisplay = (node) => {\n    const streetNumber = node[DataConstants.STREET_NUMBER_KEY_NAME]\n    const street = node[DataConstants.STREET_KEY_NAME]\n    const address = (streetNumber && street) ? `${(streetNumber ? `${streetNumber} ` : null)}${street}` : null\n    const city = node[DataConstants.CITY_KEY_NAME]\n    const state = node[DataConstants.STATE_KEY_NAME]\n    const cityState = (city || state) ? `${city}${city ? `, ${state}` : state}` : null\n    const zip = node[DataConstants.ZIP_KEY_NAME]\n    const location = `${address || 'No street address provided'}\\n${cityState || 'No city/state provided'}${zip ? `\\n${zip}` : ''}`\n    const kindness = node[DataConstants.KINDNESS_KEY_NAME]\n\n    // apply necessary parsing for date\n    const date = node.dateTime\n    const dateString = date.toLocaleString(DateTime.DATETIME_SHORT)\n\n    return {\n        kindness,\n        dateString,\n        location,\n        cityState,\n    }\n}\n\nexport {\n    processRawSheetsData,\n    nodesAreEqual,\n    computeLngLatBoundingBox,\n    filterTraceListForNode,\n    formatFieldsForDisplay,\n}\n","import * as d3 from 'd3'\nimport mapboxgl from \"mapbox-gl\"\nimport * as DataConstants from '../../utils/dataConstants'\nimport * as DataUtils from '../../utils/dataUtils'\n\nconst POINT_ZOOM = 12\nconst ZOOM_EASE_MILLIS = 3000\nconst POINT_ZOOM_MILES = 1\nconst RATIO_PAD = 0.1\n\nconst initializeMap = ({ setMap, mapContainer }) => {\n    const map = new mapboxgl.Map({\n        container: mapContainer.current,\n        style: 'mapbox://styles/mapbox/light-v10',\n        center: [-100, 40],\n        zoom: 3,\n    })\n\n    map.on(\"load\", () => {\n        setMap(map)\n    })\n}\n\nconst zoomMapToBoundingObject = (map, boundingObject) => {\n    const { topRight, bottomLeft } = boundingObject\n    map.fitBounds([\n        [bottomLeft.lng, bottomLeft.lat],\n        [topRight.lng, topRight.lat]\n    ], {\n        duration: ZOOM_EASE_MILLIS,\n    })\n}\n\nconst showTooltip = (e, d) => {\n    const tooltip = d3.select('.map-tooltip')\n    tooltip\n        .transition()\n        .duration(0)\n        .style('opacity', 0.8)\n        .style('left', `${e.pageX + 50}px`)\n        .style('top', `${e.pageY - 50}px`)\n}\n\nconst hideTooltip = (callback) => {\n    const tooltip = d3.select('.map-tooltip')\n    tooltip\n        .transition().duration(500)\n        .style(\"opacity\", 0)\n        .on('end', callback)\n}\n\nconst resetAllCircleColors = (fill = 'steelblue') => {\n    return d3.selectAll('.circle')\n        .transition()\n        .duration(500)\n        .style('fill', fill)\n        .style('opacity', 1)\n}\n\nconst clearAllEventHandlers = (selection) => {\n    selection\n        .on('mouseover', null)\n        .on('mousemove', null)\n        .on('mouseout', null)\n        .on('click', null)\n}\n\n// write function to generate ID of circle\nconst uniqueCircleId = d => `circle-${d.index}`\n\n// write function to generate class of circle based off id key\nconst circleClass = d => `circle circle-${d[DataConstants.ID_KEY_NAME]}`\n\n// write function to quickly convert a data array to the fomat for lat lng\nconst generateLngLatArray = data => data.map(d => ({\n    lng: d[DataConstants.CENTER_LNG_KEY_NAME],\n    lat: d[DataConstants.CENTER_LAT_KEY_NAME],\n}))\n\n// write projection function for map\nconst projectLngLatToXY = (map, d) => {\n    return map.project(\n        new mapboxgl.LngLat(d[DataConstants.CENTER_LNG_KEY_NAME], d[DataConstants.CENTER_LAT_KEY_NAME])\n    )\n}\n\nconst zoomToDataPoint = (map, d) => {\n    map.flyTo({\n        center: [\n            d[DataConstants.CENTER_LNG_KEY_NAME],\n            d[DataConstants.CENTER_LAT_KEY_NAME],\n        ],\n        zoom: POINT_ZOOM,\n        essential: true\n    })\n}\n\nconst mapRender = (map) => {\n    d3.selectAll('.circle')\n        .attr('cx', d => projectLngLatToXY(map, d).x)\n        .attr('cy', d => projectLngLatToXY(map, d).y)\n}\n\nconst getBoudingObjectForTraceList = (trace) => {\n    return DataUtils.computeLngLatBoundingBox(\n        generateLngLatArray(trace),\n        trace.length > 1 ? RATIO_PAD : POINT_ZOOM_MILES,\n        trace.length > 1 ? true : false,\n        trace.length > 1 ? true : false,\n    )\n}\n\nconst bringCircleWithIdToFront = (id) => {\n    setTimeout(() => {\n        d3.select('.map-svg')\n            .selectAll('use')\n            .remove()\n\n        d3.select('.map-svg')\n            .append('use')\n            .attr('xlink:href', id)\n    }, 500)\n}\n\nconst getPrevAndNextNodes = (trace, selectedNode) => {\n    const traceIndex = trace.indexOf(selectedNode)\n    const prevNode = traceIndex > 0 ? trace[traceIndex - 1] : null\n    const nextNode = traceIndex < trace.length - 1 ? trace[traceIndex + 1] : null\n    return {\n        prevNode,\n        nextNode,\n    }\n}\n\nexport {\n    initializeMap,\n    zoomMapToBoundingObject,\n    showTooltip,\n    hideTooltip,\n    resetAllCircleColors,\n    clearAllEventHandlers,\n    uniqueCircleId,\n    circleClass,\n    generateLngLatArray,\n    projectLngLatToXY,\n    zoomToDataPoint,\n    mapRender,\n    getBoudingObjectForTraceList,\n    bringCircleWithIdToFront,\n    getPrevAndNextNodes,\n}\n","import * as turf from '@turf/turf'\nimport * as DataConstants from '../../utils/dataConstants'\nimport arrowImage from '../../arrow.png'\n\nconst MILES_PER_STEP = 10\nconst MIN_NUM_STEPS = 100\n\nconst convertDatumToLngLatArray = d => [\n    d[DataConstants.CENTER_LNG_KEY_NAME],\n    d[DataConstants.CENTER_LAT_KEY_NAME],\n]\n\nconst computePointId = (id) => `${id}-point`\n\nconst constructFeatureCollection = (origin, destination) => ({\n    'type': 'FeatureCollection',\n    'features': [\n        {\n            'type': 'Feature',\n            'geometry': {\n                'type': 'LineString',\n                'coordinates': [\n                    convertDatumToLngLatArray(origin),\n                    convertDatumToLngLatArray(destination),\n                ],\n            },\n        },\n    ],\n})\n\nconst arcifyFeatureCollection = (route) => {\n    // src: https://docs.mapbox.com/mapbox-gl-js/example/animate-point-along-route/\n    // Calculate the distance in kilometers between route start/end point.\n    const lineDistance = turf.length(route.features[0])\n    const numSteps = Math.max(Math.floor(lineDistance / MILES_PER_STEP), MIN_NUM_STEPS)\n\n    const arc = []\n\n    // Draw an arc between the `origin` & `destination` of the two points\n    for (var i = 0; i < lineDistance; i += lineDistance / numSteps) {\n        const segment = turf.along(route.features[0], i)\n        arc.push(segment.geometry.coordinates)\n    }\n\n    // append a final segment\n    const segment = turf.along(route.features[0], lineDistance)\n    arc.push(segment.geometry.coordinates)\n\n    // Update the route with calculated arc coordinates\n    route.features[0].geometry.coordinates = arc\n    return {\n        route,\n        numSteps,\n    }\n}\n\nconst drawArcBetweenNodes = (map, origin, destination) => {\n    const id = `${origin.hash} -> ${destination.hash}`\n    const idPoint = computePointId(id)\n\n    // if already exists, just return\n    if (map.getSource(id)) {\n        return id\n    }\n\n    const route = constructFeatureCollection(origin, destination)\n    const arcifyResult = arcifyFeatureCollection(route)\n    const routeProc = arcifyResult.route\n    const { numSteps } = arcifyResult\n\n    console.log(numSteps, '!!!!!!')\n\n    // set up point to animate\n    // A single point that animates along the route.\n    // Coordinates are initially set to origin.\n    const point = {\n        'type': 'FeatureCollection',\n        'features': [\n            {\n                'type': 'Feature',\n                'properties': {},\n                'geometry': {\n                    'type': 'Point',\n                    'coordinates': convertDatumToLngLatArray(origin),\n                },\n            },\n        ],\n    }\n\n    map.addSource(id, {\n        'type': 'geojson',\n        'data': routeProc\n    })\n\n    map.addLayer({\n        'id': id,\n        'source': id,\n        'type': 'line',\n        'paint': {\n            'line-width': 5,\n            'line-color': '#007cbf'\n        },\n        'layout': {\n            'line-cap': 'round',\n            'line-join': 'round',\n        },\n    })\n\n    map.loadImage(\n        arrowImage,\n        function (error, image) {\n            if (error) throw error;\n\n            // Add the image to the map style.\n            map.addImage('arrow', image)\n\n            \n\n\n        }\n    );\n\n    map.addSource(idPoint, {\n        'type': 'geojson',\n        'data': point\n    })\n\n    map.addLayer({\n        'id': idPoint,\n        'source': idPoint,\n        'type': 'symbol',\n        'layout': {\n            // This icon is a part of the Mapbox Streets style.\n            // To view all images available in a Mapbox style, open\n            // the style in Mapbox Studio and click the \"Images\" tab.\n            // To add a new image to the style at runtime see\n            // https://docs.mapbox.com/mapbox-gl-js/example/add-image/\n            'icon-image': 'arrow', // works: heliport-15\n            // doesn't work: rectangle-blue-2\n            'icon-rotate': ['get', 'bearing'],\n            'icon-rotation-alignment': 'map',\n            'icon-allow-overlap': true,\n            'icon-ignore-placement': true,\n            'icon-size': .1,\n        }\n    })\n\n    let counter = 0\n\n    const animatePoint = () => {\n        var start =\n            route.features[0].geometry.coordinates[\n            counter >= numSteps ? counter - 1 : counter\n            ]\n        var end =\n            route.features[0].geometry.coordinates[\n            counter >= numSteps ? counter : counter + 1\n            ]\n        if (!start || !end) return;\n\n        // Update point geometry to a new position based on counter denoting\n        // the index to access the arc\n        point.features[0].geometry.coordinates =\n            route.features[0].geometry.coordinates[counter]\n\n        // Calculate the bearing to ensure the icon is rotated to match the route arc\n        // The bearing is calculated between the current point and the next point, except\n        // at the end of the arc, which uses the previous point and the current point\n        point.features[0].properties.bearing = turf.bearing(\n            turf.point(start),\n            turf.point(end)\n        )\n\n        // Update the source with this new data\n        const source = map.getSource(idPoint)\n        if (!source) {\n            // this has been removed - stop the animation\n            return\n        }\n\n        source.setData(point)\n\n        // Request the next frame of animation as long as the end has not been reached\n        if (counter < numSteps) {\n            requestAnimationFrame(animatePoint)\n        } else {\n            counter = -1\n            requestAnimationFrame(animatePoint)\n        }\n\n        counter = counter + 1\n    }\n\n    // start the animation\n    animatePoint()\n\n    return id\n}\n\nconst clearArcsForId = (map, id) => {\n    if (!id) {\n        return\n    }\n\n    map.removeLayer(id)\n    map.removeSource(id)\n\n    // also clear the associated point\n    const idPoint = computePointId(id)\n    map.removeLayer(idPoint)\n    map.removeSource(idPoint)\n}\n\nexport {\n    drawArcBetweenNodes,\n    clearArcsForId,\n}\n","export default \"data:image/png;base64,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\"","import * as DataConstants from '../../utils/dataConstants'\nimport * as StringUtils from '../../utils/stringUtils'\nimport * as DataUtils from '../../utils/dataUtils'\n\nconst TooltipContents = ({ node, isSelected }) => {\n    // handle null node case\n    if (! node) {\n        return null;\n    }\n\n    console.log('rendering tooltip')\n\n    const {\n        kindness,\n        cityState,\n    } = DataUtils.formatFieldsForDisplay(node)\n\n\n    return (\n        <div>\n            <p><b>{StringUtils.trimWithElipses(kindness, 140)}</b></p>\n            <p><i>{cityState}</i></p>\n            <p>{! isSelected ? 'Click for more info!' : null}</p>\n        </div>\n    )\n}\n\nexport default TooltipContents\n","const trimWithElipses = (inp, length) => {\n    if (inp.length > length) {\n        return `${inp.substring(0, length)}...`\n    }\n    \n    return inp\n}\n\nexport {\n    trimWithElipses\n}","const DEFAULT = 'default'\nconst SELECTED = 'selected'\nconst SEARCHING = 'searching'\nconst TRACING = 'tracing'\n\nexport {\n    DEFAULT,\n    SELECTED,\n    SEARCHING,\n    TRACING,\n}\n","import React, { useEffect, useRef, useState } from 'react'\nimport mapboxgl from 'mapbox-gl'\nimport * as d3 from 'd3'\nimport * as MapUtils from './mapUtils'\nimport * as LineUtils from './lineUtils'\nimport * as DataConstants from '../../utils/dataConstants'\nimport MapboxWorker from 'worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker'\nimport TooltipContents from '../tooltip'\nimport * as DataUtils from '../../utils/dataUtils'\nimport * as AppMode from '../../utils/appMode'\n\nimport '../../styles/Map.css'\n\nconst DEFAULT_RADIUS = 10\nconst BIG_RADIUS = 20\n\nmapboxgl.accessToken = 'pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ'\nmapboxgl.workerClass = MapboxWorker\n\nconst MapboxGLMap = ({ trace, setIsLoading, selectedNode, setSelectedNode, hoveredNode, setHoveredNode, mode, setTrace, resetTrace }) => {\n    const [map, setMap] = useState(null)\n    const [boundingObject, setBoundingObject] = useState(null)\n    const mapContainer = useRef(null)\n    const [prevLineId, setPrevLineId] = useState(null)\n    const [nextLineId, setNextLineId] = useState(null)\n\n    // todo refactor\n    const drawAndZoomLines = () => {\n        const {\n            prevNode,\n            nextNode,\n        } = MapUtils.getPrevAndNextNodes(trace, selectedNode)\n\n        let newPrevLineId, newNextLineId\n\n        if (prevNode) {\n            newPrevLineId = LineUtils.drawArcBetweenNodes(map, prevNode, selectedNode)\n        }\n        if (nextNode) {\n            newNextLineId = LineUtils.drawArcBetweenNodes(map, selectedNode, nextNode)\n        }\n\n        // delete any arcs that are not currently drawn\n        if (prevLineId !== newPrevLineId && prevLineId !== newNextLineId) {\n            LineUtils.clearArcsForId(map, prevLineId)\n        }\n        if (nextLineId !== newPrevLineId && nextLineId !== newNextLineId) {\n            LineUtils.clearArcsForId(map, nextLineId)\n        }\n\n        // update our ids\n        setPrevLineId(newPrevLineId)\n        setNextLineId(newNextLineId)\n\n        // update the bounding box to include current, prev and next\n        const nodes = [selectedNode]\n        if (prevNode) {\n            nodes.push(prevNode)\n        }\n        if (nextNode) {\n            nodes.push(nextNode)\n        }\n        const boundingObjectNew = MapUtils.getBoudingObjectForTraceList(nodes)\n        setBoundingObject(boundingObjectNew)\n\n        // return the prev and next for reference\n        return {\n            nodes,\n        }\n    }\n\n    const clearAllLines = () => {\n        if (!map)\n            return\n\n        // clear any previous ids\n        LineUtils.clearArcsForId(map, prevLineId)\n        LineUtils.clearArcsForId(map, nextLineId)\n\n        // clear the ids\n        setPrevLineId(null)\n        setNextLineId(null)\n    }\n\n    // let's init our map first again\n    useEffect(() => {\n        if (map === null) {\n            // need to init the map since it is null\n            MapUtils.initializeMap({ setMap, mapContainer })\n        } else {\n            // also append an svg to the map for later use\n            // TODO put this in css\n            var container = map.getCanvasContainer()\n            d3.select(container)\n                .append('svg')\n                .attr('class', 'map-svg')\n                .attr('width', '100%')\n                .attr('height', '100%')\n                .style('position', 'absolute')\n                .style('z-index', 2)\n                .style('top', 0)\n                .style('left', 0)\n\n            // also set up map events for re-render\n            map.on('viewreset', () => MapUtils.mapRender(map))\n            map.on('move', () => MapUtils.mapRender(map))\n            map.on('moveend', () => MapUtils.mapRender(map))\n        }\n    }, [map])\n\n    // here is where we do our data join for trace points\n    useEffect(() => {\n        if (map && trace) {\n            // do a data join on all the trace points with d3\n            console.log('>>> JOINING')\n            d3.select('.map-svg')\n                .selectAll('circle')\n                .data(trace, d => d.hash)\n                .join(\n                    enter => enter\n                        .append('circle')\n                        .attr('id', MapUtils.uniqueCircleId)\n                        .attr('class', MapUtils.circleClass)\n                        .attr('r', DEFAULT_RADIUS)\n                        .style('fill', 'steelblue')\n                        .style('opacity', d => {\n                            if (selectedNode && DataUtils.nodesAreEqual(d, selectedNode)) {\n                                return 1\n                            } else if (selectedNode && !DataUtils.nodesAreEqual(d, selectedNode)) {\n                                return 0.5\n                            } else {\n                                return 1\n                            }\n                        })\n                        .on('click', (e, d) => setSelectedNode(d))\n                        .on('mouseover', (e, d) => {\n                            setHoveredNode(d)\n                            MapUtils.showTooltip(e, d)\n                        })\n                        .on('mouseout', (e, d) => {\n                            MapUtils.hideTooltip(() => setHoveredNode(null))\n                        }),\n                    update => update,\n                    exit => exit.remove()\n                )\n\n            // perform initial render\n            MapUtils.mapRender(map)\n\n            // also complete loading\n            setIsLoading(false)\n\n            // update bounding box with the initial view\n            const boundingObjectNew = MapUtils.getBoudingObjectForTraceList(trace)\n            setBoundingObject(boundingObjectNew)\n        }\n    }, [map, trace])\n\n    // THE PURPOSE OF THIS EFFECT IS TO ZOOM ON THE MAP\n    // WE RE-ZOOM WHEN:\n    // 1. BOUNDING BOX CHANGES\n    // 2. SELECTED NODE BECOMES NULL \n    // listen for changes in the bounding box\n    useEffect(() => {\n        if (map && boundingObject) {\n            MapUtils.zoomMapToBoundingObject(map, boundingObject)\n\n            // always clear the tooltip and hovered node in this case\n            setTimeout(() => MapUtils.hideTooltip(() => setHoveredNode(null)), 500)\n        }\n    }, [map, boundingObject])\n\n    // listen for changes in the selected node\n    // IF GENERAL NON TRACE MODE\n    //     IF SELECTED NODE NON NULL, ZOOM TO IT AND MAKE IT RED\n    //     ELSE, RESET TO ALL POINTS AND MAKE ALL POINTS BLUE\n    // IF TRACE MODE\n    //     MAKE IT GREEN, ALL OTHERS PURPLE\n    useEffect(() => {\n        if (mode === AppMode.SELECTED && selectedNode) {\n            // handle colors\n            // make other circles not red, and less opaque\n            MapUtils.resetAllCircleColors()\n                .style('opacity', 0.5)\n\n            // make this circle red and dark\n            const id = `#${MapUtils.uniqueCircleId(selectedNode)}`\n            d3.select(id)\n                .transition()\n                .duration(500)\n                .style('fill', 'red')\n                .style('opacity', 1)\n                .attr('r', DEFAULT_RADIUS)\n\n            // draw it over all other circles\n            MapUtils.bringCircleWithIdToFront(id)\n\n            // update bounding box\n            const boundingObjectNew = MapUtils.getBoudingObjectForTraceList([selectedNode])\n            setBoundingObject(boundingObjectNew)\n        } else if ((mode === AppMode.DEFAULT || mode === AppMode.SEARCHING) && trace) {\n            // reset the bounding box to original trace points\n            const boundingObjectNew = MapUtils.getBoudingObjectForTraceList(trace)\n            setBoundingObject(boundingObjectNew)\n\n            // also clear the color\n            MapUtils.resetAllCircleColors()\n        } else if (mode === AppMode.TRACING) {\n            // if we have selected the root node, we need to be sure to zoom to original trace\n            if (selectedNode[DataConstants.ID_KEY_NAME] === DataConstants.ROOT_ACT_ID) {\n                const boundingObjectNew = MapUtils.getBoudingObjectForTraceList(trace)\n                setBoundingObject(boundingObjectNew)\n            }\n\n            // set up our lines\n            const {\n                nodes,\n            } = drawAndZoomLines()\n\n            console.log(nodes, 'jaflfjljfjslfjks')\n\n            // update circle colors\n            d3.selectAll('.circle')\n                .filter(d => nodes.indexOf(d) === -1)\n                .transition()\n                .duration(500)\n                .style('fill', 'purple')\n                .style('opacity', 0)\n                .attr('r', DEFAULT_RADIUS)\n\n            d3.selectAll('.circle')\n                .filter(d => (nodes.indexOf(d) > -1 && d.hash !== selectedNode.hash))\n                .transition()\n                .duration(500)\n                .style('fill', 'purple')\n                .style('opacity', 1)\n                .attr('r', DEFAULT_RADIUS)\n\n            // make the selected node bigger and green\n            const id = `#${MapUtils.uniqueCircleId(selectedNode)}`\n\n            d3.select(id)\n                .transition()\n                .duration(500)\n                .style('fill', 'green')\n                .attr('r', BIG_RADIUS) // TODO add this back if we want\n                .style('opacity', 1)\n\n            // draw it over all other circles\n            MapUtils.bringCircleWithIdToFront(id)\n\n        }\n    }, [mode, selectedNode, trace])\n\n    // listen for changes in the mode state\n    // re-filter the trace list as needed\n    useEffect(() => {\n        if (mode === AppMode.TRACING) {\n            // filter on the current node\n            const traceNew = DataUtils.filterTraceListForNode(trace, selectedNode)\n            setTrace(traceNew)\n            return\n        }\n\n        // non-trace mode - clear all lines\n        clearAllLines()\n\n        if (mode === AppMode.DEFAULT) {\n            // reset trace back to original data array\n            resetTrace()\n        } else if (mode === AppMode.SEARCHING) {\n            // do nothing, this should be handled by the search bar\n        } else if (mode === AppMode.SELECTED) {\n            // reset trace back to original data array\n            resetTrace()\n        }\n    }, [mode])\n\n    return <div ref={el => (mapContainer.current = el)} className='map-container-div'>\n        {\n            mode !== AppMode.TRACING ? (\n                <div className='map-tooltip' style={{ 'opacity': 0 }}>\n                    <TooltipContents node={hoveredNode} isSelected={DataUtils.nodesAreEqual(hoveredNode, selectedNode)} />\n                </div>\n            ) : null\n        }\n    </div>\n}\n\nexport default MapboxGLMap\n","import * as DataUtils from '../../utils/dataUtils'\n\nconst KindnessCard = ({ node }) => {\n    console.log('rendering card')\n    // handle null node case\n    if (! node) {\n        return null;\n    }\n\n    console.log(node)\n\n    const {\n        kindness,\n        dateString,\n        location,\n    } = DataUtils.formatFieldsForDisplay(node)\n\n    return (\n        <div className=\"kindness-card-inner\">\n            <p>Act of Kindness:</p>\n            <div className=\"kindness-card-description\">\n                <p><b>{kindness || 'No kindness description provided!'}</b></p>\n            </div>\n            <p>Location:</p>\n            <p><b>{location}</b></p>\n            <p>Date & Time:</p>\n            <p><b>{dateString}</b></p>\n        </div>\n    )\n}\n\nexport default KindnessCard","import '../../styles/Loading.css'\n\nconst LoadingSpinner = () => {\n    console.log('rendering loading')\n    return (\n        <div className=\"loading-wrapper\">\n            <div className=\"la-ball-clip-rotate la-2x\">\n                <div></div>\n            </div>\n            <p>Loading...</p>\n        </div>\n    )\n}\n\nexport default LoadingSpinner\n","import MouseIcon from '@material-ui/icons/Mouse'\nimport ExploreIcon from '@material-ui/icons/Explore'\nimport ToggleOffIcon from '@material-ui/icons/ToggleOff'\nimport SearchIcon from '@material-ui/icons/Search'\n\n/*\n    Simple component to render some useful info when no node is selected.\n*/\nconst SidebarInfoCard = () => {\n    console.log('rendering side info card')\n    return (\n        <div>\n            <hr className=\"sidebar-divider\" />\n            <div className=\"sidebar-info-row\">\n                <div className=\"sidebar-info-left\">\n                    <MouseIcon fontSize=\"large\" />\n                </div>\n                <div className=\"sidebar-info-right\">\n                    <p><b>Click</b> a circle to explore that act of kindness further!</p>\n                </div>\n            </div>\n            <div className=\"sidebar-info-row\">\n                <div className=\"sidebar-info-left\">\n                    <ExploreIcon fontSize=\"large\" />\n                </div>\n                <div className=\"sidebar-info-right\">\n                    <p>Then, you can <b>trace</b> that act of kindness to see how may people have paid it forward.</p>\n                </div>\n            </div>\n            <div className=\"sidebar-info-row sidebar-info-row-toggle\">\n                <div className=\"sidebar-info-left\">\n                    <ToggleOffIcon fontSize=\"large\" />\n                </div>\n                <div className=\"sidebar-info-right\">\n                    <p>Switch between <b>real-time</b> and <b>generated</b> data using the toggle below.</p>\n                </div>\n            </div>\n            <div className=\"sidebar-info-row sidebar-info-row-search\">\n                <div className=\"sidebar-info-left\">\n                    <SearchIcon fontSize=\"large\" />\n                </div>\n                <div className=\"sidebar-info-right\">\n                    <p><b>Search</b> for acts of kindness by description, location, or ID.</p>\n                </div>\n            </div>\n        </div >\n    )\n}\n\n// Search for acts of kindness by description, location, or ID\n\nexport default SidebarInfoCard","import KindnessCard from './kindnessCard'\nimport { Button } from '@material-ui/core'\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward'\n\nconst TraceStepper = ({ exitTraceMode, trace, selectedNode, setSelectedNode }) => {\n    console.log('rendering trace')\n\n    // find the trace index\n    const traceIndex = trace.indexOf(selectedNode)\n\n    const n = trace.length\n\n    return (\n        <div className=\"trace-stepper-wrapper\">\n            <div className=\"trace-stepper-button-exit\">\n                <Button variant=\"contained\" style={{ backgroundColor: 'red', color: 'white' }} onClick={exitTraceMode}>\n                    Exit Trace Mode\n                </Button>\n            </div>\n            <div className=\"trace-stepper-button-horizontal\">\n                <Button\n                    className=\"trace-stepper-button\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={traceIndex === 0}\n                    onClick={() => setSelectedNode(trace[0])}\n                >\n                    First\n                </Button>\n                <Button\n                    className=\"trace-stepper-button\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={traceIndex === 0}\n                    onClick={() => setSelectedNode(trace[traceIndex - 1])}\n                >\n                    <ArrowBackIcon />\n                </Button>\n                <Button\n                    className=\"trace-stepper-button\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={traceIndex === n - 1}\n                    onClick={() => setSelectedNode(trace[traceIndex + 1])}\n                >\n                    <ArrowForwardIcon />\n                </Button>\n                <Button\n                    className=\"trace-stepper-button\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disabled={traceIndex === n - 1}\n                    onClick={() => setSelectedNode(trace[n - 1])}\n                >\n                    Last\n                </Button>\n            </div>\n            <p>{`${traceIndex + 1} / ${trace.length}`}</p>\n            <KindnessCard node={selectedNode} />\n        </div>\n    )\n}\n\nexport default TraceStepper\n","import FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Switch from '@material-ui/core/Switch';\nimport * as DataConstants from '../..//utils/dataConstants'\n\nconst DataToggle = ({ dataUrl, setDataUrl }) => {\n    const checked = dataUrl === DataConstants.REAL_DATA_URL\n\n    const handleChange = (event) => {\n        const eventChecked = event.target.checked\n        const dataUrlNew = eventChecked ? DataConstants.REAL_DATA_URL : DataConstants.SPOOF_DATA_URL\n        setDataUrl(dataUrlNew)\n    }\n\n    const label = dataUrl === DataConstants.REAL_DATA_URL ? 'Viewing Real Data' : 'Viewing Fake Data'\n    \n    return (\n        <FormControlLabel\n            control={\n                <Switch\n                    checked={checked}\n                    onChange={handleChange}\n                    // value={'checked'}\n                    color='primary'\n                />\n            }\n            labelPlacement='top'\n            label={label}\n        />\n    )\n}\n\nexport default DataToggle","import React from 'react'\nimport { Button } from '@material-ui/core'\nimport '../../styles/Sidebar.css'\nimport KindnessCard from './kindnessCard'\nimport LoadingSpinner from './loadingSpinner'\nimport SidebarInfoCard from './infoCard'\nimport TraceStepper from './traceStepper'\nimport DataToggle from './dataToggle'\nimport * as DataUtils from '../../utils/dataUtils'\nimport * as AppMode from '../../utils/appMode'\n\nconst Sidebar = ({ isLoading, selectedNode, setSelectedNode, clearSelectedNode, mode, setMode, trace, dataUrl, setDataUrl, filterText }) => {\n    console.log('rendering sidebar')\n\n    // get a trace count\n    let traceCount = 0\n    if (selectedNode) {\n        const traceFilterList = DataUtils.filterTraceListForNode(trace, selectedNode)\n        traceCount = traceFilterList.length\n    }\n    return (\n        <div className=\"sidebar-flex\">\n            <h1>Kindness Tracker</h1>\n            {\n                isLoading ? <LoadingSpinner /> : null\n            }\n            {\n                !isLoading && mode === AppMode.DEFAULT ? <SidebarInfoCard /> : null\n            }\n            {\n                mode === AppMode.SELECTED ? (\n                    <div className=\"sidebar-clear-div\">\n                        <Button variant=\"contained\" style={{ backgroundColor: 'red', color: 'white' }} className=\"sidebar-button-below\" onClick={clearSelectedNode}>Clear Selection</Button>\n                        <Button variant=\"contained\" style={{ backgroundColor: 'green', color: 'white' }} className=\"sidebar-button-below\" onClick={() => setMode(AppMode.TRACING)}>Trace this Act!</Button>\n                        <h1>{traceCount}</h1>\n                        <p>acts of kindness are connected</p>\n                    </div>\n                ) : null\n            }\n            { mode === AppMode.SELECTED ? (\n                <div className=\"selected-card-wrapper\">\n                    <KindnessCard node={selectedNode} />\n                </div>\n            ) : null\n            }\n            {\n                mode === AppMode.TRACING ? (\n                    <TraceStepper\n                        exitTraceMode={() => setMode(AppMode.SELECTED)}\n                        trace={trace}\n                        selectedNode={selectedNode}\n                        setSelectedNode={setSelectedNode}\n                    />\n                ) : null\n            }\n            {\n                mode === AppMode.SEARCHING && trace.length > 0 ? (\n                    <div className=\"sidebar-clear-div\">\n                        <h1>{trace.length}</h1>\n                        <p>{trace.length > 1 ? 'acts' : 'act'} found for search query \"{filterText}\".</p>\n                        <p>Press Esc to clear.</p>\n                    </div>\n                ) : null\n            }\n            <div className=\"sidebar-bottom-content\">\n                <div className=\"data-toggle-outer\">\n                    <DataToggle\n                        dataUrl={dataUrl}\n                        setDataUrl={setDataUrl}\n                    />\n                </div>\n                <p className=\"sidebar-small-text\">Christian Moroney, Jackson Bernatchez, Kevin Lyons</p>\n                <p className=\"sidebar-small-text\">6.859 Final Project Spring 2021</p>\n                <div>\n                    <a href=\"https://github.com/6859-sp21/final-project-kindness-tracker\" target=\"_blank\">\n                        <img className=\"sidebar-git-image\" src=\"https://image.flaticon.com/icons/png/512/25/25231.png\"></img>\n                    </a>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Sidebar\n","import React, { useEffect, useState } from 'react'\nimport SearchBar from 'material-ui-search-bar'\n\nconst KindnessSearchBar = ({ filterNodes, filterText, setFilterText }) => {\n    return (\n        <SearchBar\n          value={filterText || ''}\n          onChange={setFilterText}\n          cancelOnEscape={true}\n          onRequestSearch={() => filterNodes(filterText)}\n          onCancelSearch={() => { setFilterText(null); filterNodes(null) }}\n          placeholder={'Search for acts of kindness by description, location, or ID. Press Enter to search. ⏎'}\n        />\n      );\n}\n\nexport default KindnessSearchBar","import React, { useEffect, useState } from 'react'\nimport Tabletop from 'tabletop'\nimport { Sidebar, KindnessSearchBar, MapboxGLMap } from './components'\nimport mapboxgl from 'mapbox-gl/dist/mapbox-gl-csp'\nimport MapboxWorker from 'worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker'\nimport TrieSearch from 'trie-search'\nimport * as DataConstants from './utils/dataConstants'\nimport * as DataUtils from './utils/dataUtils'\nimport * as AppMode from './utils/appMode'\n\nconst MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ'\nmapboxgl.workerClass = MapboxWorker\nmapboxgl.accessToken = MAPBOX_ACCESS_TOKEN\n\nimport './styles/App.css'\n\nconst App = () => {\n  const [data, setData] = useState(null)\n  const [trace, setTrace] = useState(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [selectedNode, setSelectedNode] = useState(null)\n  const [hoveredNode, setHoveredNode] = useState(null)\n  const [dataUrl, setDataUrl] = useState(DataConstants.REAL_DATA_URL)\n  const [trie, setTrie] = useState(null)\n  const [filterText, setFilterText] = useState(null)\n  const [mode, setMode] = useState(AppMode.DEFAULT)\n\n  useEffect(() => {\n    // on first render, check the width\n    // if less than 800, provide alert about screen size\n    if (window.innerWidth < 800) {\n      alert('We see you\\'re on mobile! Rotate your phone sideways for the best experience. Check out our app on your computer too!')\n    }\n  }, [])\n\n  const fetchData = () => {\n    console.log('fetching!')\n    Tabletop.init({\n      key: dataUrl,\n      simpleSheet: true,\n    })\n      .then(data => {\n        // process data right away\n        const dataProc = DataUtils.processRawSheetsData(data)\n        setData(dataProc)\n        setTrace(dataProc)\n\n        // set up our search object\n        const ts = new TrieSearch([\n          DataConstants.ID_KEY_NAME,\n          DataConstants.KINDNESS_KEY_NAME,\n          DataConstants.STREET_KEY_NAME,\n          DataConstants.CITY_KEY_NAME,\n          DataConstants.STATE_KEY_NAME,\n          DataConstants.ZIP_KEY_NAME,\n        ])\n        ts.addAll(dataProc)\n        setTrie(ts)\n      })\n      .catch(console.warn)\n  }\n\n  useEffect(() => {\n    if (data === null) {\n      fetchData()\n    }\n  }, [data])\n\n  // listen for changes in the data url via a toggle\n  useEffect(() => {\n    if (data !== null) {\n      // reset all required state before re-fetch\n      setIsLoading(true)\n      setSelectedNode(null)\n      setFilterText(null)\n      setHoveredNode(null)\n      setMode(AppMode.DEFAULT)\n      fetchData()\n    }\n  }, [dataUrl])\n\n  // define function to set trace back to original data array\n  const resetTrace = () => setTrace(data)\n\n  // function to clear selected node\n  const clearSelectedNode = () => {\n    setSelectedNode(null)\n    setMode(AppMode.DEFAULT)\n    setFilterText(null)\n  }\n\n  // define function to filter nodes based on a query string\n  const filterNodes = (text) => {\n    // update state\n    setIsLoading(true)\n\n    // handle no filter\n    if (!text) {\n      // reset to all data\n      setTrace(data)\n      setIsLoading(false)\n      setMode(AppMode.DEFAULT)\n      return\n    }\n\n    const dataFiltSearch = trie.get(text)\n\n    // handle empty data case\n    if (dataFiltSearch.length === 0) {\n      // TODO clean this up\n      alert('No results found! Try another search query.')\n      setIsLoading(false)\n      setMode(AppMode.DEFAULT)\n      return\n    }\n\n    setSelectedNode(null)\n    setHoveredNode(null)\n    setMode(AppMode.SEARCHING)\n    setTrace(dataFiltSearch)\n  }\n\n  const handleSetSelectedNode = (node) => {\n    // change to selection mode\n    setMode(AppMode.SELECTED)\n\n    // reset the trace\n    resetTrace()\n\n    // update the selected node as normal\n    setSelectedNode(node)\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"horizontal-stack\">\n        <div className=\"left-sidebar\">\n          <Sidebar\n            isLoading={isLoading}\n            selectedNode={selectedNode}\n            setSelectedNode={setSelectedNode}\n            clearSelectedNode={clearSelectedNode}\n            mode={mode}\n            setMode={setMode}\n            trace={trace}\n            dataUrl={dataUrl}\n            setDataUrl={setDataUrl}\n            filterText={filterText}\n          />\n        </div>\n        <div className=\"vertical-stack\">\n          {\n            mode === AppMode.DEFAULT || mode === AppMode.SEARCHING ? (\n              <div className=\"search-bar-wrapper\">\n                <KindnessSearchBar\n                  filterText={filterText}\n                  setFilterText={setFilterText}\n                  filterNodes={filterNodes}\n                />\n              </div>\n            ) : null\n          }\n          <div className=\"map-wrapper\">\n            <MapboxGLMap\n              trace={trace}\n              setIsLoading={setIsLoading}\n              selectedNode={selectedNode}\n              setSelectedNode={handleSetSelectedNode}\n              hoveredNode={hoveredNode}\n              setHoveredNode={setHoveredNode}\n              mode={mode}\n              setTrace={setTrace}\n              resetTrace={resetTrace}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}