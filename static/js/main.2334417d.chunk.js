(this["webpackJsonpkindness-tracker"]=this["webpackJsonpkindness-tracker"]||[]).push([[0],{127:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(31),i=n.n(a),o=(n(127),n(3)),s=n(109),l=n.n(s),d=n(17),u=n(9),j=n(1),b=n(35),f=n.n(b),h="https://docs.google.com/spreadsheets/d/1IqEBIcnFZ_BFCrD8jhk11yVoOjfxzZpiZLdL4cL3oK0/pubhtml",p="What is the ID Number on your kindness card? (We need this to track the spread of kindness!)",m="street_name",O="admin_level_3",g="admin_level_1",v="zip_code",x="Tell us about the act of kindness you received!",y="center_lng",N="center_lat",k=n(68),S=n(69),w="lng",T="lat",C=function(e,t){return!(!e||!t)&&e.index==t.index},M=function(e,t){var n=t[p];return(0===n?e:e.filter((function(e){return e[p]===n||0===e[p]}))).sort((function(e,t){return e.dateTime.toMillis()-t.dateTime.toMillis()}))},_=function(e){var t=e.street_number,n=e.street_name,c=t&&n?"".concat(t?"".concat(t," "):null).concat(n):null,r=e.admin_level_3,a=e.admin_level_1,i=r||a?"".concat(r).concat(r?", ".concat(a):a):null,o=e.zip_code,s="".concat(c||"No street address provided","\n").concat(i||"No city/state provided").concat(o?"\n".concat(o):"");return{kindness:e[x],dateString:e.dateTime.toLocaleString(S.DateTime.DATETIME_SHORT),location:s,cityState:i}},F=function(e){u.select(".map-tooltip").transition().duration(500).style("opacity",0).on("end",e)},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"steelblue";return u.selectAll(".circle").transition().duration(500).style("fill",e).style("opacity",1)},D=function(e){return"circle-".concat(e.index)},I=function(e){return"circle circle-".concat(e[p])},E=function(e,t){return e.project(new f.a.LngLat(t.center_lng,t.center_lat))},J=function(e){u.selectAll(".circle").attr("cx",(function(t){return E(e,t).x})).attr("cy",(function(t){return E(e,t).y}))},A=function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=0,r=0;n||(c=t/69),r=c;var a=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?1:5,i=function(t){return e.map((function(e){return e[t]}))},o=Math.max.apply(Math,Object(d.a)(i(w))),s=Math.min.apply(Math,Object(d.a)(i(w))),l=Math.max.apply(Math,Object(d.a)(i(T))),u=Math.min.apply(Math,Object(d.a)(i(T)));return n&&(c=(o-s)*t,r=12*t*(l-u)),{topRight:{lng:o+c,lat:u+r},bottomLeft:{lng:s-c*a,lat:l-r}}}(e.map((function(e){return{lng:e.center_lng,lat:e.center_lat}})),e.length>1?.1:1,e.length>1,e.length>1)},z=function(e){setTimeout((function(){u.select(".map-svg").selectAll("use").remove(),u.select(".map-svg").append("use").attr("xlink:href",e)}),500)},P=n(28),U=n.p+"static/media/triangle.c5a97129.png",R=function(e){return[e.center_lng,e.center_lat]},Y=function(e){return"".concat(e,"-point")},B=function(e,t,n){var c="".concat(t.hash," -> ").concat(n.hash),r=Y(c);if(e.getSource(c))return c;var a=function(e,t){return{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:[R(e),R(t)]}}]}}(t,n),i=function(e){for(var t=P.length(e.features[0]),n=Math.max(Math.floor(t/10),100),c=[],r=0;r<t;r+=t/n){var a=P.along(e.features[0],r);c.push(a.geometry.coordinates)}var i=P.along(e.features[0],t);return c.push(i.geometry.coordinates),e.features[0].geometry.coordinates=c,{route:e,numSteps:n}}(a),o=i.route,s=i.numSteps;console.log(s,"!!!!!!");var l={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:R(t)}}]};e.addSource(c,{type:"geojson",data:o}),e.addLayer({id:c,source:c,type:"line",paint:{"line-width":5,"line-color":"black"},layout:{"line-cap":"round","line-join":"round"}}),e.hasImage("triangle")||e.loadImage(U,(function(t,n){if(t)throw t;e.addImage("triangle",n)})),e.addSource(r,{type:"geojson",data:l}),e.addLayer({id:r,source:r,type:"symbol",layout:{"icon-image":"triangle","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-size":.02}});var d=0;return function t(){var n=a.features[0].geometry.coordinates[d>=s?d-1:d],c=a.features[0].geometry.coordinates[d>=s?d:d+1];if(n&&c){l.features[0].geometry.coordinates=a.features[0].geometry.coordinates[d],l.features[0].properties.bearing=P.bearing(P.point(n),P.point(c));var i=e.getSource(r);i&&(i.setData(l),d<s||(d=0),setTimeout((function(){return requestAnimationFrame(t)}),500),d+=10)}}(),c},K=function(e,t){if(t){e.removeLayer(t),e.removeSource(t);var n=Y(t);e.removeLayer(n),e.removeSource(n)}},Z=n(54),q=function(e){var t=e.node,n=e.isSelected;if(!t)return null;console.log("rendering tooltip");var c,r,a=_(t),i=a.kindness,o=a.cityState;return Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:(c=i,r=140,c.length>r?"".concat(c.substring(0,r),"..."):c)})}),Object(j.jsx)("p",{children:Object(j.jsx)("i",{children:o})}),Object(j.jsx)("p",{children:n?null:"Click for more info!"})]})},H="default",W="selected",G="searching",V="tracing";n(152);f.a.accessToken="pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ",f.a.workerClass=Z.a;var X=function(e){var t=e.trace,n=e.setIsLoading,r=e.selectedNode,a=e.setSelectedNode,i=e.hoveredNode,s=e.setHoveredNode,l=e.mode,d=e.setTrace,b=e.resetTrace,h=Object(c.useState)(null),m=Object(o.a)(h,2),O=m[0],g=m[1],v=Object(c.useState)(null),x=Object(o.a)(v,2),y=x[0],N=x[1],k=Object(c.useRef)(null),S=Object(c.useState)(null),w=Object(o.a)(S,2),T=w[0],_=w[1],E=Object(c.useState)(null),P=Object(o.a)(E,2),U=P[0],R=P[1];return Object(c.useEffect)((function(){if(null===O)!function(e){var t=e.setMap,n=e.mapContainer,c=new f.a.Map({container:n.current,style:"mapbox://styles/mapbox/light-v10",center:[-100,40],zoom:3});c.on("load",(function(){t(c)}))}({setMap:g,mapContainer:k});else{var e=O.getCanvasContainer();u.select(e).append("svg").attr("class","map-svg").attr("width","100%").attr("height","100%").style("position","absolute").style("z-index",2).style("top",0).style("left",0),O.on("viewreset",(function(){return J(O)})),O.on("move",(function(){return J(O)})),O.on("moveend",(function(){return J(O)}))}}),[O]),Object(c.useEffect)((function(){if(O&&t){console.log(">>> JOINING"),u.select(".map-svg").selectAll("circle").data(t,(function(e){return e.hash})).join((function(e){return e.append("circle").attr("id",D).attr("class",I).attr("r",10).style("fill","steelblue").style("opacity",(function(e){return r&&C(e,r)?1:r&&!C(e,r)?.5:1})).on("click",(function(e,t){return a(t)})).on("mouseover",(function(e,t){s(t),function(e,t){u.select(".map-tooltip").transition().duration(0).style("opacity",.8).style("left","".concat(e.pageX+50,"px")).style("top","".concat(e.pageY-50,"px"))}(e)})).on("mouseout",(function(e,t){F((function(){return s(null)}))}))}),(function(e){return e}),(function(e){return e.remove()})),J(O),n(!1);var e=A(t);N(e)}}),[O,t]),Object(c.useEffect)((function(){O&&y&&(!function(e,t){var n=t.topRight,c=t.bottomLeft;e.fitBounds([[c.lng,c.lat],[n.lng,n.lat]],{duration:3e3})}(O,y),setTimeout((function(){return F((function(){return s(null)}))}),500))}),[O,y]),Object(c.useEffect)((function(){if(l===W&&r){L().style("opacity",.5);var e="#".concat(D(r));u.select(e).transition().duration(500).style("fill","red").style("opacity",1).attr("r",10),z(e);var n=A([r]);N(n)}else if(l!==H&&l!==G||!t){if(l===V){if(0===r[p]){var c=A(t);N(c)}var a=function(){var e,n,c=function(e,t){var n=e.indexOf(t);return{prevNode:n>0?e[n-1]:null,nextNode:n<e.length-1?e[n+1]:null}}(t,r),a=c.prevNode,i=c.nextNode;a&&(e=B(O,a,r)),i&&(n=B(O,r,i)),T!==e&&T!==n&&K(O,T),U!==e&&U!==n&&K(O,U),_(e),R(n);var o=[r];a&&o.push(a),i&&o.push(i);var s=A(o);return N(s),{nodes:o}}().nodes;console.log(a,"jaflfjljfjslfjks"),u.selectAll(".circle").filter((function(e){return-1===a.indexOf(e)})).transition().duration(500).style("fill","purple").style("opacity",0).attr("r",10),u.selectAll(".circle").filter((function(e){return a.indexOf(e)>-1&&e.hash!==r.hash})).transition().duration(500).style("fill","purple").style("opacity",1).attr("r",10);var i="#".concat(D(r));u.select(i).transition().duration(500).style("fill","green").attr("r",20).style("opacity",1),z(i)}}else{var o=A(t);N(o),L()}}),[l,r,t]),Object(c.useEffect)((function(){if(l!==V)O&&(K(O,T),K(O,U),_(null),R(null)),l===H?b():l===G||l===W&&b();else{var e=M(t,r);d(e)}}),[l]),Object(j.jsx)("div",{ref:function(e){return k.current=e},className:"map-container-div",children:l!==V?Object(j.jsx)("div",{className:"map-tooltip",style:{opacity:0},children:Object(j.jsx)(q,{node:i,isSelected:C(i,r)})}):null})},Q=n(210),$=(n(153),function(e){var t=e.node;if(console.log("rendering card"),!t)return null;console.log(t);var n=_(t),c=n.kindness,r=n.dateString,a=n.location;return Object(j.jsxs)("div",{className:"kindness-card-inner",children:[Object(j.jsx)("p",{children:"Act of Kindness:"}),Object(j.jsx)("div",{className:"kindness-card-description",children:Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:c||"No kindness description provided!"})})}),Object(j.jsx)("p",{children:"Location:"}),Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:a})}),Object(j.jsx)("p",{children:"Date & Time:"}),Object(j.jsx)("p",{children:Object(j.jsx)("b",{children:r})})]})}),ee=(n(154),function(){return console.log("rendering loading"),Object(j.jsxs)("div",{className:"loading-wrapper",children:[Object(j.jsx)("div",{className:"la-ball-clip-rotate la-2x",children:Object(j.jsx)("div",{})}),Object(j.jsx)("p",{children:"Loading..."})]})}),te=n(111),ne=n.n(te),ce=n(112),re=n.n(ce),ae=n(113),ie=n.n(ae),oe=n(67),se=n.n(oe),le=function(){return console.log("rendering side info card"),Object(j.jsxs)("div",{children:[Object(j.jsx)("hr",{className:"sidebar-divider"}),Object(j.jsxs)("div",{className:"sidebar-info-row",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(ne.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Click"})," a circle to explore that act of kindness further!"]})})]}),Object(j.jsxs)("div",{className:"sidebar-info-row",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(re.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:["Then, you can ",Object(j.jsx)("b",{children:"trace"})," that act of kindness to see how may people have paid it forward."]})})]}),Object(j.jsxs)("div",{className:"sidebar-info-row sidebar-info-row-toggle",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(ie.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:["Switch between ",Object(j.jsx)("b",{children:"real-time"})," and ",Object(j.jsx)("b",{children:"generated"})," data using the toggle below."]})})]}),Object(j.jsxs)("div",{className:"sidebar-info-row sidebar-info-row-search",children:[Object(j.jsx)("div",{className:"sidebar-info-left",children:Object(j.jsx)(se.a,{fontSize:"large"})}),Object(j.jsx)("div",{className:"sidebar-info-right",children:Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Search"})," for acts of kindness by description, location, or ID."]})})]})]})},de=n(114),ue=n.n(de),je=n(115),be=n.n(je),fe=function(e){var t=e.exitTraceMode,n=e.trace,c=e.selectedNode,r=e.setSelectedNode;console.log("rendering trace");var a=n.indexOf(c),i=n.length;return Object(j.jsxs)("div",{className:"trace-stepper-wrapper",children:[Object(j.jsx)("div",{className:"trace-stepper-button-exit",children:Object(j.jsx)(Q.a,{variant:"contained",style:{backgroundColor:"red",color:"white"},onClick:t,children:"Exit Trace Mode"})}),Object(j.jsxs)("div",{className:"trace-stepper-button-horizontal",children:[Object(j.jsx)(Q.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:0===a,onClick:function(){return r(n[0])},children:"First"}),Object(j.jsx)(Q.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:0===a,onClick:function(){return r(n[a-1])},children:Object(j.jsx)(ue.a,{})}),Object(j.jsx)(Q.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:a===i-1,onClick:function(){return r(n[a+1])},children:Object(j.jsx)(be.a,{})}),Object(j.jsx)(Q.a,{className:"trace-stepper-button",variant:"contained",color:"primary",disabled:a===i-1,onClick:function(){return r(n[i-1])},children:"Last"})]}),Object(j.jsx)("p",{children:"".concat(a+1," / ").concat(n.length)}),Object(j.jsx)($,{node:c})]})},he=n(211),pe=n(212),me=function(e){var t=e.dataUrl,n=e.setDataUrl,c=t===h,r=t===h?"Viewing Real Data":"Viewing Fake Data";return Object(j.jsx)(he.a,{control:Object(j.jsx)(pe.a,{checked:c,onChange:function(e){var t=e.target.checked;n(t?h:"https://docs.google.com/spreadsheets/d/1ILNeaJC675bNSCWHgAK-2hD6MNZB38PYh7Y90MncF50/pubhtml")},color:"primary"}),labelPlacement:"top",label:r})},Oe=function(e){var t=e.isLoading,n=e.selectedNode,c=e.setSelectedNode,r=e.clearSelectedNode,a=e.mode,i=e.setMode,o=e.trace,s=e.dataUrl,l=e.setDataUrl,d=e.filterText;console.log("rendering sidebar");var u=0;n&&(u=M(o,n).length);return Object(j.jsxs)("div",{className:"sidebar-flex",children:[Object(j.jsx)("h1",{children:"Kindness Tracker"}),t?Object(j.jsx)(ee,{}):null,t||a!==H?null:Object(j.jsx)(le,{}),a===W?Object(j.jsxs)("div",{className:"sidebar-clear-div",children:[Object(j.jsx)(Q.a,{variant:"contained",style:{backgroundColor:"red",color:"white"},className:"sidebar-button-below",onClick:r,children:"Clear Selection"}),Object(j.jsx)(Q.a,{variant:"contained",style:{backgroundColor:"green",color:"white"},className:"sidebar-button-below",onClick:function(){return i(V)},children:"Trace this Act!"}),Object(j.jsx)("h1",{children:u}),Object(j.jsx)("p",{children:"acts of kindness are connected"})]}):null,a===W?Object(j.jsx)("div",{className:"selected-card-wrapper",children:Object(j.jsx)($,{node:n})}):null,a===V?Object(j.jsx)(fe,{exitTraceMode:function(){return i(W)},trace:o,selectedNode:n,setSelectedNode:c}):null,a===G&&o.length>0?Object(j.jsxs)("div",{className:"sidebar-clear-div",children:[Object(j.jsx)("h1",{children:o.length}),Object(j.jsxs)("p",{children:[o.length>1?"acts":"act",' found for search query "',d,'".']}),Object(j.jsx)("p",{children:"Press Esc to clear."})]}):null,Object(j.jsxs)("div",{className:"sidebar-bottom-content",children:[Object(j.jsx)("div",{className:"data-toggle-outer",children:Object(j.jsx)(me,{dataUrl:s,setDataUrl:l})}),Object(j.jsx)("p",{className:"sidebar-small-text",children:"Christian Moroney, Jackson Bernatchez, Kevin Lyons"}),Object(j.jsx)("p",{className:"sidebar-small-text",children:"6.859 Final Project Spring 2021"}),Object(j.jsx)("div",{children:Object(j.jsx)("a",{href:"https://github.com/6859-sp21/final-project-kindness-tracker",target:"_blank",children:Object(j.jsx)("img",{className:"sidebar-git-image",src:"https://image.flaticon.com/icons/png/512/25/25231.png"})})})]})]})},ge=n(117),ve=n.n(ge),xe=function(e){var t=e.filterNodes,n=e.filterText,c=e.setFilterText;return Object(j.jsx)(ve.a,{value:n||"",onChange:c,cancelOnEscape:!0,onRequestSearch:function(){return t(n)},onCancelSearch:function(){c(null),t(null)},placeholder:"Search for acts of kindness by description, location, or ID. Press Enter to search. \u23ce"})},ye=n(71),Ne=n.n(ye),ke=n(72),Se=n.n(ke);n(190);Ne.a.workerClass=Z.a,Ne.a.accessToken="pk.eyJ1IjoiY21vcm9uZXkiLCJhIjoiY2tudGNscDJjMDFldDJ3b3pjMTh6ejJyayJ9.YAPmFkdy_Eh9K20cFlIvaQ";var we=function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),i=Object(o.a)(a,2),s=i[0],d=i[1],u=Object(c.useState)(!0),b=Object(o.a)(u,2),f=b[0],w=b[1],T=Object(c.useState)(null),C=Object(o.a)(T,2),M=C[0],_=C[1],F=Object(c.useState)(null),L=Object(o.a)(F,2),D=L[0],I=L[1],E=Object(c.useState)(h),J=Object(o.a)(E,2),A=J[0],z=J[1],P=Object(c.useState)(null),U=Object(o.a)(P,2),R=U[0],Y=U[1],B=Object(c.useState)(null),K=Object(o.a)(B,2),Z=K[0],q=K[1],V=Object(c.useState)(H),Q=Object(o.a)(V,2),$=Q[0],ee=Q[1];Object(c.useEffect)((function(){window.innerWidth<800&&alert("We see you're on mobile! Rotate your phone sideways for the best experience. Check out our app on your computer too!")}),[]);var te=function(){console.log("fetching!"),l.a.init({key:A,simpleSheet:!0}).then((function(e){var t=function(e){var t=e?e.map((function(e,t){return Object(k.a)(Object(k.a)({},e),{},{index:t,dateTime:S.DateTime.fromFormat(e.Timestamp,"M/d/yyyy H:mm:ss"),hash:"".concat(t,"-").concat(e.Timestamp)})})):null,n=[p,y,N];return t.map((function(e){return n.forEach((function(t){e[t]=+e[t]})),e}))}(e);r(t),d(t);var n=new Se.a([p,x,m,O,g,v],{idFieldOrFunction:"index"});n.addAll(t),Y(n)})).catch(console.warn)};Object(c.useEffect)((function(){null===n&&te()}),[n]),Object(c.useEffect)((function(){null!==n&&(w(!0),_(null),q(null),I(null),ee(H),te())}),[A]);var ne=function(){return d(n)};return Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)("div",{className:"horizontal-stack",children:[Object(j.jsx)("div",{className:"left-sidebar",children:Object(j.jsx)(Oe,{isLoading:f,selectedNode:M,setSelectedNode:_,clearSelectedNode:function(){_(null),ee(H),q(null)},mode:$,setMode:ee,trace:s,dataUrl:A,setDataUrl:z,filterText:Z})}),Object(j.jsxs)("div",{className:"vertical-stack",children:[$===H||$===G?Object(j.jsx)("div",{className:"search-bar-wrapper",children:Object(j.jsx)(xe,{filterText:Z,setFilterText:function(e){ee(H),q(e)},filterNodes:function(e){if(w(!0),!e)return d(n),w(!1),void ee(H);var t=R.get(e.split(" "),Se.a.UNION_REDUCER);if(0===t.length)return alert("No results found! Try another search query."),w(!1),void ee(H);_(null),I(null),ee(G),d(t)}})}):null,Object(j.jsx)("div",{className:"map-wrapper",children:Object(j.jsx)(X,{trace:s,setIsLoading:w,selectedNode:M,setSelectedNode:function(e){ee(W),ne(),_(e)},hoveredNode:D,setHoveredNode:I,mode:$,setTrace:d,resetTrace:ne})})]})]})})},Te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,213)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(we,{})}),document.getElementById("root")),Te()}},[[191,1,2]]]);
//# sourceMappingURL=main.2334417d.chunk.js.map