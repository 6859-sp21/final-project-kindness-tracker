<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>Sample Page</title>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    const dataUrl = 'https://docs.google.com/spreadsheets/d/1IqEBIcnFZ_BFCrD8jhk11yVoOjfxzZpiZLdL4cL3oK0/edit?usp=sharing'

    const processSheetsData = (response) => {
      const array = []
      const data = response.getDataTable()
      const numColumns = data.getNumberOfColumns()
      const numRows = data.getNumberOfRows()

      // get column names as first row
      const columnNames = []

      for (var r = 0; r < numRows; r++) {
        const row = {};
        for (var c = 0; c < numColumns; c++) {
          const value = data.getFormattedValue(r, c)
          if (r === 0) {
            columnNames.push(value)
          } else {
            row[columnNames[c]] = value
          }
        }
        if (r > 0) {
          array.push(row)
        }
      }
      console.log(array, columnNames)
    }

    const init = () => {
      const query = new google.visualization.Query(dataUrl)
      query.setQuery('select *')
      query.send(processSheetsData)
    }

    google.charts.load('current')
    google.charts.setOnLoadCallback(init)
  </script>
</head>

<body>

</body>

</html>